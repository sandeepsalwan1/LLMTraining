# Asymptote Code-Image Dataset Builder & Gemma 3 Interaction

This project provides tools to automatically build datasets of Asymptote vector graphics code paired with their rendered images and scripts for interacting with Google's Gemma 3 models using Unsloth. The primary focus is on the `makeDataset.py` script, designed to process Asymptote files from any source repository to create training data.

## Core Functionality

*   **Automated Asymptote Dataset Creation (`makeDataset.py`):**
    *   Recursively searches a specified input directory (default: `asymptote-exemples/`) for `.asy` files. You can populate `asymptote-exemples/` with Asymptote files from any repository or source.
    *   Compiles valid 2D Asymptote code into PNG images, storing them in `asy_images/`. (Currently skips files importing the `three` module).
    *   Generates `asymp_dataset.json`, where each record pairs the original Asymptote code with its corresponding rendered image path and a standard instruction. This dataset can then be used for training image-to-code or code-to-image models.
*   **Gemma 3 Model Interaction:**
    *   `gemma3Training.py`: Placeholder script intended for fine-tuning Gemma 3 models using Unsloth. Currently, it's a minimal Unsloth setup.
    *   `Inference.py` & `Inference.ipynb`: Scripts demonstrating how to load and interact with pre-trained or fine-tuned Gemma 3 models for text-based or (if model supports) multimodal inference. (Note: The provided content for these files shows multimodal interaction attempts, requiring a model trained for such tasks).

## Project Structure

sandeepsalwan1-llmtraining/
├── README.md
├── config.asy          # Asymptote configuration (e.g., texpath)
├── gemma3Training.py   # Placeholder for Gemma 3 model training
├── Inference.ipynb     # Jupyter Notebook for model inference
├── Inference.py        # Python script for model inference
├── LICENSE
├── makeDataset.py      # Builds the Asymptote code-image dataset
├── asy_images/         # Output directory for images rendered by makeDataset.py
└── tests/              # (Typically for test scripts, currently empty or not detailed)
# User needs to create/populate for makeDataset.py:
# └── asymptote-exemples/ # Place target .asy files here
# Generated by makeDataset.py:
# └── asymp_dataset.json

code


## Setup

### Prerequisites

1.  **Python 3.x**
2.  **Asymptote:** Must be installed and accessible from your system's PATH. ([https://asymptote.sourceforge.io/](https://asymptote.sourceforge.io/))
3.  **TeX Distribution:** Required by Asymptote for label typesetting (e.g., TeX Live, MiKTeX).
    *   `makeDataset.py` uses `texpath="/Library/TeX/texbin"` (macOS default). Adjust this in the script or ensure your TeX binaries are in the system PATH if this is incorrect for your setup. The `config.asy` file can also specify `texpath`.
4.  **Python Packages:**
    *   `Pillow` (for image validation in `makeDataset.py`)
    *   For model interaction/training (`gemma3Training.py`, `Inference.py`): `unsloth`, `torch`, `transformers`, etc. (Refer to Unsloth's installation guide: [https://github.com/unslothai/unsloth](https://github.com/unslothai/unsloth)).

    Example:
    ```bash
    pip install Pillow
    # For Unsloth & Hugging Face libraries (adapt to your environment, e.g., CUDA version):
    pip install "unsloth[cu121] @ git+https://github.com/unslothai/unsloth.git"
    pip install "transformers>=4.38.0" # Or a specific version for Gemma 3
    ```

## Usage

### 1. Building an Asymptote Code-Image Dataset

1.  **Prepare Asymptote Files:**
    *   Create a directory named `asymptote-exemples` in the project root.
    *   Populate this `asymptote-exemples` directory with the `.asy` files you want to process (e.g., from a cloned Git repository or any collection of Asymptote code).
2.  **Configure TeX Path (if necessary):**
    *   Modify the `texpath` variable within `makeDataset.py` (around line 50 in the `cmd` list) if `"/Library/TeX/texbin"` is not correct for your system and Asymptote cannot find your TeX distribution automatically.
3.  **Run the Dataset Creation Script:**
    ```bash
    python makeDataset.py
    ```
    This will:
    *   Clean and create the `asy_images/` directory.
    *   Process `.asy` files from `asymptote-exemples/`.
    *   Output compiled PNG images into `asy_images/`.
    *   Create `asymp_dataset.json` with code-image pairs.

### 2. Interacting with Gemma 3 Models

*   **Using `Inference.py` or `Inference.ipynb`:**
    *   These scripts (based on the provided content) demonstrate loading a Gemma 3 model via Unsloth and setting up an interactive chat loop.
    *   They are geared towards multimodal interaction, expecting an `IMAGE_TOKEN` and prompting for image paths. To use them effectively for image-related tasks, you would need a Gemma 3 model that has been fine-tuned for multimodal inputs.
    *   If using a text-only model, you would adapt these scripts to remove image-specific logic.
*   **Fine-Tuning (`gemma3Training.py`):**
    *   This script is currently a basic setup for loading a Gemma 3 model with Unsloth.
    *   To fine-tune (e.g., on `asymp_dataset.json` for an image-to-code task), you would need to:
        1.  Implement data loading for `asymp_dataset.json`, including image preprocessing.
        2.  Configure Unsloth's `SFTTrainer` or a custom training loop for multimodal training.
        3.  Ensure LoRA targets and model components are correctly set up for learning from both image and text/code data.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
